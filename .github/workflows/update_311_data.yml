name: Update 311 Police Data

on:
  workflow_dispatch:  # elle tetikleme
  schedule:
    - cron: '0 6 1 * *'  # Her ayÄ±n 1'i, 06:00 UTC (San Francisco'da 23:00 Ã¶nceki gÃ¼n)

jobs:
  update-311:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ“¥ Reponun en son halini klonla
      uses: actions/checkout@v3

    - name: ğŸ Python ortamÄ±nÄ± hazÄ±rla
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: ğŸ“¦ Gerekli paketleri yÃ¼kle
      run: |
        pip install pandas geopandas shapely requests fiona pyproj rtree

    - name: ğŸš€ 311 verisini gÃ¼ncelle (update_311_data.py)
      run: |
        python scripts/update_311_data.py

    - name: ğŸ”„ Ã‡Ä±ktÄ± dosyalarÄ±nÄ± GitHub'a ekle
      run: |
        git config user.name "github-actions"
        git config user.email "github-actions@users.noreply.github.com"
        git add crime_data/sf_311_last_5_years.csv
        git add crime_data/311_requests_range.csv
        git add crime_data/sf_crime_04.csv
        git commit -m "ğŸ”„ 311 verisi otomatik gÃ¼ncellendi: $(date -u +'%Y-%m-%d %H:%M:%S')"
        git push
